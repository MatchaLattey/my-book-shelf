<!DOCTYPE html>
<html>
<head>
  <style>
    :root {
      --frame-color: #b68d6d; 
      --shelf-bg: #fffaf2;   
      /* Database Colors */
      --db-primary: #0a3d4d;
      --db-accent: #20c20e;
    }

    body { background-color: transparent; display: flex; justify-content: center; padding: 10px; font-family: 'Segoe UI', sans-serif; }
    
    #settings-container {
      position: fixed; top: 10px; right: 10px; z-index: 100;
      display: flex; flex-direction: column; align-items: flex-end;
    }
    #gear-icon { font-size: 24px; cursor: pointer; background: white; border-radius: 50%; padding: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.3); opacity: 0.8; }
    #settings-menu {
      display: none; background: white; padding: 15px; border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4); width: 240px; margin-top: 8px; font-size: 12px;
    }
    #settings-container:hover #settings-menu { display: block; }

    /* BOOKCASE */
    .bookcase {
      width: 100%; max-width: 450px; background: var(--frame-color);
      display: grid; grid-template-rows: repeat(4, 1fr); gap: 15px;
      padding: 20px; border: 10px solid #a37a5a; border-radius: 4px;
    }
    .shelf {
      height: 125px; background-color: var(--shelf-bg); border-bottom: 10px solid #a37a5a;
      display: flex; align-items: flex-end; padding: 0 15px; gap: 6px; position: relative;
    }
    
    /* THE DYNAMIC BOOK */
    .book {
      position: relative;
      background-color: var(--db-primary);
      /* Database Pattern Overlay */
      background-image:  radial-gradient(#20c20e 0.5px, transparent 0.5px), radial-gradient(#20c20e 0.5px, #0a3d4d 0.5px);
      background-size: 10px 10px;
      background-position: 0 0, 5px 5px;
      
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 3px 3px 0 0;
      transition: transform 0.2s;
      cursor: pointer;
      display: flex; justify-content: center; align-items: center;
      writing-mode: vertical-rl;
      font-size: 9px;
      font-weight: bold;
      color: white;
      text-transform: uppercase;
      box-shadow: inset -3px 0 5px rgba(0,0,0,0.3);
    }

    .book:hover { transform: translateY(-10px) scale(1.05); z-index: 10; }

    /* RANDOM SIZE CLASSES */
    .book-thin { width: 18px; height: 80px; font-size: 7px; }
    .book-standard { width: 32px; height: 100px; }
    .book-fat { width: 45px; height: 115px; border-left: 4px solid rgba(255,255,255,0.1); }

    /* STATUS ICONS (BADGES) */
    .status-badge {
      position: absolute;
      bottom: 5px;
      right: 5px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      writing-mode: horizontal-tb;
      box-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    .status-Read .status-badge::after { content: '‚úÖ'; }
    .status-Reading .status-badge::after { content: 'üìñ'; }
    .status-TBR .status-badge { display: none; } /* No icon for unread */

    .deco { position: absolute; bottom: 5px; z-index: 5; pointer-events: none; }
  </style>
</head>
<body>

<div id="settings-container">
  <div id="gear-icon">‚öôÔ∏è</div>
  <div id="settings-menu">
    <div class="menu-header">Shelf Settings</div>
    <button class="save-btn" onclick="saveSettings()">üíæ SAVE MY DESIGN</button>
  </div>
</div>

<div class="bookcase">
  <div class="shelf" id="shelf-1"></div>
  <div class="shelf" id="shelf-2"></div>
  <div class="shelf" id="shelf-3"></div>
  <div class="shelf" id="shelf-4"></div>
</div>

<script>
  // ... (Your existing config and settings logic remains the same) ...
  let config = {
    workerUrl: 'https://notion-bridge.violily67.workers.dev/', 
    color: '#b68d6d',
    clockImg: 'https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3B4eW13bmZ5ZnR4eW13bmZ5ZnR4eW13bmZ5ZnR4eW13bmZ5JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1z/3o7TKVUn7iM8FMEU24/giphy.gif',
    plantImg: 'https://i.pinimg.com/originals/1f/4e/ba/1f4eba6f27790b213ba570f8ba63273c.gif',
    clockShelf: '2', plantShelf: '3', clockSize: '45', plantSize: '60'
  };

  async function fetchBooks() {
    try {
      const response = await fetch(config.workerUrl);
      const books = await response.json();
      
      // Clear shelves before re-adding
      document.querySelectorAll('.shelf').forEach(s => s.innerHTML = '');

      books.forEach(book => {
        const shelf = document.getElementById(`shelf-${book.shelf}`);
        if (shelf) {
          const el = document.createElement('div');
          
          // 1. AUTOMATIC SIZE LOGIC
          // We use a simple randomizer or you can base it on book title length
          const sizes = ['book-thin', 'book-standard', 'book-fat'];
          const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
          
          el.className = `book ${randomSize} status-${book.status}`;
          el.title = book.title;
          el.innerText = book.title.substring(0, 12);

          // 2. ADD STATUS BADGE
          const badge = document.createElement('div');
          badge.className = 'status-badge';
          el.appendChild(badge);

          shelf.appendChild(el);
        }
      });
    } catch (e) { console.error("Error:", e); }
  }

  fetchBooks();
</script>
</body>
</html>
